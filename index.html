<!DOCTYPE html>
<html lang="no">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
<title>Meeting Timer</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#f8f7f5">
<link rel="icon" href="./img/favicon.png">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@600;700;800;900&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#f8f7f5; --ink:#2b3432; --muted:#8b827a;
  --card:#fff; --border:rgba(40,30,20,.10);
  --green:#6ecf9e;
  --phase-intro:#87b9ff;
  --phase-review:#ffb766;
  --phase-outro:#87b9ff;
  --press:#cfc7bd; --pill:#fffefb; --radius:16px;
  --tl-green-1:#e9f3ec; --tl-green-2:#deefe4;
  --content-max:min(640px, 94vw);
}
*{box-sizing:border-box; -webkit-tap-highlight-color:transparent}
html,body{margin:0;height:100%}
body{
  color:var(--ink);
  font-family:"Nunito",ui-rounded,-apple-system,BlinkMacSystemFont,"SF Pro Text","SF Pro Display",Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  letter-spacing:.01em; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; min-height:100%;
  background-color:var(--bg);
  background-image: linear-gradient(rgba(255,255,255,.72), rgba(255,255,255,.72)), url('./img/paper-texture.png');
  background-size: auto, 300px 300px; background-repeat: repeat, repeat; background-attachment: fixed, fixed;
}
.container{flex:1 0 auto;max-width:980px;margin:0 auto;padding:16px 16px 28px;min-width:280px}
.footer{flex:0 0 auto;text-align:center;color:var(--muted);font-size:.9rem;padding:10px 0 14px}

.h1{font-size:clamp(1.1rem, 2.8vw, 1.38rem);font-weight:900;margin:18px auto 10px;max-width:var(--content-max);text-transform:uppercase}
.message{background:var(--pill);border:2px solid var(--border);border-radius:12px;padding:20px 22px;min-height:56px;box-shadow:0 8px 24px rgba(70,50,30,.05);margin:0 auto 20px;max-width:var(--content-max);color:#4a5552;font-size:clamp(1.05rem, 3.2vw, 1.62rem);line-height:1.3;display:flex;align-items:center}
.big-clock,.clock{margin-top:16px;font-size:clamp(1.6rem, 9vw, 2.75rem);font-weight:900;color:#2f3b34;max-width:var(--content-max);margin-inline:auto;word-wrap:break-word}
#clockWT{margin-top:40px}
#clockSP{margin-top:40px}

.controls{display:flex;gap:12px;margin-top:12px;max-width:var(--content-max);margin-inline:auto;justify-content:flex-start;flex-wrap:wrap}
.round{width:58px;height:58px;border-radius:999px;border:0;cursor:pointer;display:flex;align-items:center;justify-content:center;color:#fff;font-size:1.5rem;box-shadow:0 10px 24px rgba(70,50,30,.08)}
.round.pressed{filter:brightness(.82) saturate(1.05); box-shadow:inset 0 4px 10px rgba(0,0,0,.18),0 6px 18px rgba(70,50,30,.06)}
.play{background:var(--green)}
.pause{background:var(--phase-intro); color:#ffffff}
.stop{background:var(--phase-review); color:#2b2a29}

.preset{border:1px solid var(--border);background:var(--pill);border-radius:999px;padding:10px 14px;font-weight:900;cursor:pointer;box-shadow:0 8px 20px rgba(70,50,30,.06);color:#2f3b34;font-size:1.05rem}
.preset.active{background:#2f3b34;color:#fff}

.milestone-img{max-width:56%;height:auto;margin:10px auto 0;display:block;opacity:1}

img{-webkit-user-drag:none;user-select:none;-webkit-touch-callout:none}
</style>
</head>
<body>
<div class="container">
  <div class="topbar">
    <div class="brand" id="brandBox">
      <img id="logoImg" src="./img/meeting-timer-logo.png" alt="Meeting Timer logo">
    </div>
  </div>

  <!-- VAKTT√ÖRN -->
  <div id="wtControlsCard" class="card" style="max-width:var(--content-max);margin-inline:auto">
    <div style="display:flex;flex-direction:column;gap:10px;align-items:stretch">
      <select id="weekSel" class="select" aria-label="Artikkel"><option>Laster ‚Ä¶</option></select>
      <div style="display:flex;gap:8px;flex-wrap:wrap">
        <div class="pill" id="pillParas">Avsnitt: 0</div>
        <div class="pill" id="pillReads">üìñ Les-skriftsteder: 0</div>
      </div>
    </div>
  </div>
  <div class="h1" id="articleTitle">‚Äî</div>
  <div class="message" id="message">Velg artikkel for √• laste timer.</div>
  <div class="timeline-wrap">
    <div id="timeline" class="timeline">
      <div id="introSlot" class="slot"></div>
      <div id="reviewSlot" class="slot"></div>
      <div id="outroSlot" class="slot"></div>
      <div id="elapsed" class="elapsed"></div>
      <div id="cursor" class="cursor"></div>
    </div>
    <div class="clock" id="clockWT">00:00</div>
  </div>
  <div class="controls">
    <button id="playWT" class="round play">‚ñ∂</button>
    <button id="pauseWT" class="round pause" disabled>‚ùö‚ùö</button>
    <button id="stopWT" class="round stop" disabled>‚ñ†</button>
  </div>
  <div class="card" style="margin-top:14px;max-width:var(--content-max);margin-inline:auto">
    <textarea id="wtNotes" rows="3" style="width:100%;border:1px solid var(--border);border-radius:12px;padding:10px;font:inherit;color:#2b2a32;background:transparent;font-size:90%" placeholder="Her kan du notere."></textarea>
  </div>

  <!-- TIMER -->
  <section id="timerSection">
    <div class="card" style="max-width:var(--content-max);margin-inline:auto">
      <div class="h1">TIMER FOR MIDTUKEM√òTET</div>
      <div id="spInputs">
        <div class="preset-row">
          <button class="preset" data-sec="0">0</button>
          <button class="preset" data-sec="300">5</button>
          <button class="preset" data-sec="600">10</button>
          <button class="preset" data-sec="900">15</button>
          <button class="preset" data-sec="1200">20</button>
          <button class="preset" data-sec="1800">30</button>
        </div>
      </div>
      <div class="timeline-wrap">
        <div id="timelineSP" class="timeline">
          <div id="elapsedSP" class="elapsed"></div>
          <div id="cursorSP" class="cursor"></div>
          <div id="targetLabelSP" class="target-label" style="display:none">‚Äî</div>
        </div>
      </div>
      <div class="big-clock" id="clockSP">00:00</div>
      <img id="msImg" class="milestone-img" alt="Milestone" src="./img/pick-milestone.png"/>
      <div class="controls">
        <button id="playSP" class="round play"><span id="playSPIcon">‚ñ∂</span></button>
        <button id="pauseSP" class="round pause" disabled>‚ùö‚ùö</button>
        <button id="stopSP" class="round stop" disabled>‚ñ†</button>
      </div>
    </div>
  </section>

  <div class="footer">Meeting Timer ¬© 2025</div>
</div>

<script>
// Logo animasjon
(function(){ const logo=document.getElementById('logoImg'); if(!logo) return; logo.addEventListener('click',()=>{ logo.classList.remove('logo-spin','logo-shake'); void logo.offsetWidth; logo.classList.add('logo-spin'); setTimeout(()=>{ logo.classList.remove('logo-spin'); logo.classList.add('logo-shake'); setTimeout(()=>logo.classList.remove('logo-shake'),450); },2000); });})();

// Pressed-state helpers
function setPressedWT(id){ ['playWT','pauseWT','stopWT'].forEach(x=>{ const el=document.getElementById(x); if(el) el.classList.toggle('pressed', x===id); }); }
function setPressedSP(id){ ['playSP','pauseSP','stopSP'].forEach(x=>{ const el=document.getElementById(x); if(el) el.classList.toggle('pressed', x===id); }); }

// Init artikkel lasting
(async function init(){
  async function fetchJSON(u){ const r=await fetch(u,{cache:'no-store'}); if(!r.ok) throw 0; return r.json();}
  async function loadYear(y){ for(const p of [`data/no-${y}.json`,`Data/no-${y}.json`]){ try{ return await fetchJSON(p);}catch{} } throw 0; }
  async function hydrateOptions(){
    const today=new Date(); const year=today.getFullYear(); let items=[];
    try{ let all=[]; for(const yy of [year,year+1]){ try{ all=all.concat(await loadYear(yy)); }catch{} } items=all; }catch{}
    const sel=document.querySelector('#weekSel'); sel.innerHTML='';
    if(!items||!items.length){ const o=document.createElement('option'); o.textContent='Ingen artikler funnet'; o.disabled=true;o.selected=true; sel.appendChild(o); return; }
    items.forEach(it=>{ const o=document.createElement('option'); o.value=JSON.stringify(it); o.textContent=it.title||'(uten tittel)'; sel.appendChild(o); });
  }
  await hydrateOptions();
})();
</script>
</body>
</html>
